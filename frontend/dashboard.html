<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <link rel="stylesheet" href="index_style.css">
</head>
<body>

  <header class="navbar">
    <div class="logo"><a href="index.html">TaskPilot</a></div>
    <button id="logoutBtn" class="btn btn-outline">Logout</button>
  </header>

  <main class="auth-container">
    <div class="auth-card">
      <h2>Dashboard</h2>
      <p id="welcome">Loading...</p>
    </div>
  </main>

  <script>
    // Check authentication
    fetch("/api/dashboard", {
      credentials: "include"
    })
    .then(res => {
      if (!res.ok) throw new Error("Unauthorized");
      return res.json();
    })
    .then(data => {
      document.getElementById("welcome").innerText =
        "Welcome " + data.user.name + " ðŸ‘‹";
    })
    .catch(() => {
      window.location.href = "login.html";
    });

    // Logout logic
    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await fetch("/api/logout", {
        method: "POST",
        credentials: "include"
      });

      window.location.href = "login.html";
    });
  </script>

</body>
</html>